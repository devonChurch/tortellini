trigger: none

pool:
  vmImage: 'ubuntu-latest'

steps:
  - task: NodeTool@0
    inputs:
      versionSpec: "12.x"
    displayName: "Install Node.js"

  # Emulate `npm ci` as closely as possible with yarn.
  # @see https://classic.yarnpkg.com/en/docs/cli/install/#toc-yarn-install-frozen-lockfile
  - script: yarn install --frozen-lockfile
    displayName: "install Node.js dependencies"

  - script: yarn build:production
    displayName: "build application"
    env:
      BRANCH_NAME: $(Build.SourceBranchName)

  - publish: ./dist
    artifact: dist_build_artifact
    displayName: "publish application"
